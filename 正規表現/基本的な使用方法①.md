# 概要

さまざまなアプリケーションにおいて、「パスワードが6文字未満だったり、メールアドレスに@が入っていなかったりするとユーザー登録ができないのは、どのように判断されているのだろう？」 
といった疑問を持ったことがあるかもしれません。

これらはすべて**正規表現**という技術を用いて実装されています。


# 正規表現

正規表現とは、文字列の一部分を抽出・置換したり、文字列が制約を満たしているかを調べるための表現方法です。


## 正規表現を用いるシーン

![image](https://github.com/koharayuki/til/assets/132040884/e3f6a621-b7ca-4ac6-a75e-a6ffaee50a09)

登録フォームに電話番号を記入する欄があります。
Aさんはハイフンを付けて入力しましたが、Bさんはハイフン無しで入力をしています。
そのままデータベースに保存すると、異なるフォーマットで保存されてしまい管理が大変です。
フォーマットを統一させるために、入力された電話番号にハイフンが入っていたら必要に応じて処理をしてあげます。

![image](https://github.com/koharayuki/til/assets/132040884/34f4465a-34b4-4c20-bfce-edc5bec19d43)

このように、文字列に特定の文字が含まれているかを確認することや、特定の文字を取り除くなどの操作を行うための技術が正規表現です。
正規表現はさまざまな言語で同じようなコードで表すことができるように設計されています。そのため、ほとんどの記述をRubyやJavaScriptなどの別言語間でも共有することができます。


# 正規表現を実現する2つのメソッド(Ruby)

Rubyにおいて正規表現を利用するために重要な2つのメソッドとしてsubメソッド、matchメソッドが挙げられます。

- subメソッド
- matchメソッド

## subメソッド

`subメソッド`は、文字列の指定した部分を別の文字列に置き換えるためのメソッドです。
第1引数に置き換えたい文字列を指定し、第2引数に変換後の文字列を指定します。また、操作したい文字列は`/`で囲みます。

subメソッドは以下の例のように使用します。
```irb
irb(main):001:0> str = "りんごを食べる"
=> "りんごを食べる"

irb(main):002:0> str.sub(/りんご/,"みかん")
=> "みかんを食べる"
```

「りんごを食べる」という文字列が「みかんを食べる」という文字列に置換されました。

###  irbでsubメソッドを使った例

```ターミナル
% irb
irb(main):001:0> #ここからRubyのコードを書いていきます。
```

「おにぎりを食べる」という文字列を「ラーメンを食べる」に置換しましょう。

```ターミナル
irb(main):001:0> str = "おにぎりを食べる"
=> "おにぎりを食べる"

irb(main):002:0> str.sub(/おにぎり/,"ラーメン")
=> "ラーメンを食べる"
```

## matchメソッド

matchメソッドは、引数に指定した文字列がメソッドを使用した文字列に含まれているか否かをチェックするためのメソッドです。
含まれている場合は、指定した文字列が`MatchData`というオブジェクトが戻り値で得られます。また、含まれていない場合は、戻り値としてnilが得られます。

```ターミナル
irb(main):001:0> str = "Hello, World"
=> "Hello, World"

irb(main):002:0> str.match(/Hello/)
=> #<MatchData "Hello">

irb(main):003:0> str.match(/Good/)
=> nil
```

上の例では「Hello World」という文字列に、「Hello」という文字列が含まれているか否かをチェックしています。

## MatchData

マッチした文字列はまず、MatchDataという種類のオブジェクトで返されます。
MatchDataから実際にマッチした文字列などを取り出したい場合は、以下の様に配列から最初のデータを取り出す時と同様の形で取り出すことができます。

※コード内において、変数「md」は「MatchData」を意味します。

```ターミナル
irb(main):001:0> str = "Hello, World"
=> "Hello, World"

irb(main):002:0> md = str.match(/Hello/)
=> #<MatchData "Hello">

irb(main):003:0> md[0]
=> "Hello"
```

###  irbでmatchメソッドを使った例

irbを使って、「good friend」という文字列に「good」という文字列が含まれているか確認します。

```ターミナル
irb(main):001:0> str = "good friend"
=> "good friend"

irb(main):002:0> md = str.match(/good/)
=> #<MatchData "good">

irb(main):003:0> md[0]
=> "good"
```


## Rubyのプログラムに適用する方法

これらの正規表現や関連するメソッドをプログラムに適用する際は、if文を用います。

パターンにマッチした場合はマッチしたオブジェクトが返されます。またマッチしなかった場合はnilが返ってくるため、その性質を使用してif文で処理を分けます。

```
str = gets.chomp
if str.match(/good morning/)
  puts 'おはようございます！'
else
  puts 'あいさつが異なるようです。'
end
```





