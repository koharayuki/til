# 画面遷移を伴うユーザー登録

ユーザー新規登録の際にdeviseを利用して、ユーザーの情報（名前やメールアドレスなど）と住所の情報をページを分けて登録したい場合、ウィザード形式を用いて登録をします。

## ウィザード形式

ウィザード形式とは、対話するように順番に操作が進んでいく方式のことです。
例として、ユーザー登録の際に、最初のページでユーザー情報（名前やメールアドレスなど）の登録を行い、次のページで住所などの情報を登録するように、ページを切り替えて登録を行うことが挙げられます。
1ページで縦長に全ての情報を登録するよりも、どの情報を、どのページで登録しているのか分かるので、ユーザーからすると見やすく使いやすいという特徴があります。

## ウィザード形式を導入した実装

※ミニアプリ(wizard_app)を用いて実装をしていきます。

![image](https://github.com/koharayuki/til/assets/132040884/f8697992-ceec-4827-94d6-967a10b37d63)

データベースの構造は以下の通りです。

![image](https://github.com/koharayuki/til/assets/132040884/d9b233c4-aaaa-43c9-8f27-e87195967da9)

【ターミナル】
```
% cd ~/projects
% rails _6.0.0_ new wizard_app -d mysql
% cd wizard_app
```

### データベースを作成する

データベースを作成する前に、database.ymlに記載されているencodingの設定を変更します。

【config/database.yml】
```database.yml
default: &default
  adapter: mysql2
  # encoding: utf8mb4
  encoding: utf8
  pool: <%= ENV.fetch("RAILS_MAX_THREADS") { 5 } %>
  username: root
  password:
  socket: /tmp/mysql.sock
```

【ターミナル】
```
% rails db:create
```

以下の表示がされていれば成功です。

- Created database 'wizard_app_development'
- Created database 'wizard_app_test'

### deviseの準備

【Gemfile】
```
# 中略
gem 'devise'
```

アプリケーション内でdeviseを使えるようにするため、下記のコマンドを実行します。

【ターミナル】
```
% rails g devise:install
```

## トップページを作成する

homeコントローラーのindexアクションがトップページとなるようにします。

### ルーティングを設定する

【config/routes.rb】
```ruby
Rails.application.routes.draw do
  root to: "home#index"
end
```

### コントローラーとビューを作成する

【ターミナル】
```
% rails g controller home index
```

以下のファイルが生成されていれば成功です。

- app/controllers/home_controller.rb
- app/views/home/index.html.erb

今回indexアクションにおいては、ビューを表示させるだけです。
したがって、モデルとのやり取りはないので、コントローラー内に記述はしません。

【app/views/home/index.html.erb】
```erb
<h1>トップページ</h1>
```

以下のような表示になっていることを確認できれば準備完了です。

![image](https://github.com/koharayuki/til/assets/132040884/bb73f6a7-929a-4990-a37b-7007a76ffb9c)










